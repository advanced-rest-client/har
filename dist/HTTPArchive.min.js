/*!
 * HTTPArchive.js v1.2.2 (https://github.com/codeinchaos/httparchive.js.git)
 * Copyright 2014 Ahmad Nassri <ahmad@codeinchaos.com> (http://ahmadnassri.com)
 * Licensed under MIT License
 */

!function(a){"use strict";var b=a.HTTPArchiveLog=function(a,b){this._strict=void 0===b?!0:b,Object.defineProperties(this,{_strict:{enumerable:!1,writable:!0,value:!0},props:{enumerable:!1,configurable:!1,value:{_pages:[],_entries:[]}},comment:{enumerable:!0,writable:!0,value:void 0},version:{enumerable:!0,writable:!0,value:1.2},creator:{enumerable:!0,writable:!0,value:{name:"HTTPArchive.js",version:"1.0.0"}},browser:{enumerable:!0,writable:!0,value:void 0},pages:{enumerable:!0,get:function(){return this.props._pages},set:function(a){if(!Array.isArray(a))throw new Error("invalid HTTPArchivePage object.");for(var b in a)this.addPage(a[b])}},entries:{enumerable:!0,get:function(){return this.props._entries},set:function(a){if(!Array.isArray(a))throw new Error("invalid HTTPArchiveEntry object.");for(var b in a)this.addEntry(a[b])}}}),this.setOptions(a)};b.prototype.addPage=function(a){return a instanceof HTTPArchivePage||(a=new HTTPArchivePage(a)),this.props._pages.push(a),a},b.prototype.addEntry=function(a){return a instanceof HTTPArchiveEntry||(a=new HTTPArchiveEntry(a)),this.props._entries.push(a),a}}(window||this),function(a){"use strict";a.HTTPArchivePage=function(a,b){this._strict=void 0===b?!0:b,Object.defineProperties(this,{_strict:{enumerable:!1,writable:!0},comment:{enumerable:!0,writable:!0,value:void 0},id:{enumerable:!0,writable:!0,value:Math.floor(11*Math.random())},title:{enumerable:!0,writable:!0,value:null},pageTimings:{enumerable:!0,writable:!0,value:{onContentLoad:0,onLoad:0}},props:{enumerable:!1,configurable:!1,value:{_startedDateTime:new Date}},startedDateTime:{enumerable:!0,get:function(){return this.props._startedDateTime},set:function(a){if(!(a instanceof Date))try{a=new Date(a)}catch(b){throw new Error("invalid date object.")}this.props._startedDateTime=a}}}),this.setOptions(a)}}(window||this),function(a){"use strict";a.HTTPArchiveEntry=function(a,b){this._strict=void 0===b?!0:b,Object.defineProperties(this,{_strict:{enumerable:!1,writable:!0,value:!0},pageref:{enumerable:!0,writable:!0,value:void 0},cache:{enumerable:!0,writable:!0,value:{}},serverIPAddress:{enumerable:!0,writable:!0,value:void 0},connection:{enumerable:!0,writable:!0,value:void 0},comment:{enumerable:!0,writable:!0,value:void 0},timings:{enumerable:!0,writable:!0,value:{dns:0,connect:0,blocked:0,send:0,wait:0,receive:0}},props:{enumerable:!1,configurable:!1,value:{_startedDateTime:new Date,_time:new Date,_request:null,_response:null}},startedDateTime:{enumerable:!0,get:function(){return this.props._startedDateTime},set:function(a){if(!(a instanceof Date))try{a=new Date(a)}catch(b){throw new Error("invalid date object.")}this.props._startedDateTime=a}},time:{enumerable:!0,get:function(){return this.props._time},set:function(a){if("number"!=typeof a)throw new Error("invalid time value.");this.props._time=a}},request:{enumerable:!0,get:function(){return this.props._request},set:function(a){if(!(a instanceof HTTPArchiveRequest))try{a=new HTTPArchiveRequest(a)}catch(b){throw new Error("invalid request object.")}this.props._request=a}},response:{enumerable:!0,get:function(){return this.props._response},set:function(a){if(!(a instanceof HTTPArchiveResponse))try{a=new HTTPArchiveResponse(a)}catch(b){throw new Error("invalid response object.")}this.props._response=a}}}),this.setOptions(a)}}(window||this),function(a){"use strict";var b={parse:function(a){function b(a){return a.replace(/\+/g,"%20")}if(!a)return{};if(a=a.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,""),!a)return{};for(var c,d,e,f={},g=a.split("&"),h=g.length,i=0;h>i;i++)c=g[i].split("="),d=decodeURIComponent(b(c.shift())),e=c.length?decodeURIComponent(b(c.join("="))):null,f[d]?("string"==typeof f[d]&&(f[d]=[f[d]]),f[d].push(e)):f[d]=e;return f},construct:function(a){var b=[];return a.forEach(function(a){b.push(encodeURIComponent(a.name)+"="+encodeURIComponent(a.value))}),b.join("&")}},c=a.HTTPArchiveRequest=function(a,c){this._strict=void 0===c?!0:c,Object.defineProperties(this,new HTTPArchiveHeadersProps(this)),Object.defineProperties(this,{_strict:{enumerable:!1,writable:!0,value:!0},method:{enumerable:!0,writable:!0,value:null},httpVersion:{enumerable:!0,writable:!0,value:"HTTP/1.1"},bodySize:{enumerable:!0,writable:!0,value:0},comment:{enumerable:!0,writable:!0,value:void 0},_props:{enumerable:!1,configurable:!1,value:{_url:null,_queryString:[]}},url:{enumerable:!0,get:function(){return this._props._url},set:function(a){this._props._url=a;var c=HTTPArchiveURLRegExp.exec(this.url);this.setHeader("Host",c[2]),this.props._queryString=b.parse(c[4])}},queryString:{enumerable:!0,get:function(){var a=[];for(var b in this.props._queryString)Array.isArray(this.props._queryString[b])?this.props._queryString[b].forEach(function(c){a.push({name:b,value:c})}):a.push({name:b,value:this.props._queryString[b]});return a},set:function(a){if(!Array.isArray(a))throw new Error("invalid queryString array. expected Array, instead got "+typeof a);return a.forEach(this.setQuery,this),this}}}),this.setOptions(a)};c.prototype.getQuery=function(a){return this.props._queryString[a]},c.prototype.hasQuery=function(a){return this.props._queryString.hasOwnProperty(a)},c.prototype.countQuery=function(a){return this.hasQuery(a)?"object"==typeof this.props._queryString[a]?this.props._queryString[a].length:1:-1},c.prototype.removeQuery=function(a){return delete this.props._queryString[a],this},c.prototype.setQuery=function(a,b){if("object"==typeof a){if(!a.hasOwnProperty("name")||!a.hasOwnProperty("value"))throw new Error("invalid queryString object");this.setQuery(a.name,a.value)}else this.props._queryString[a]=b;var c=HTTPArchiveURLRegExp.exec(this._props._url);return this._props._url=this._props._url.replace(c[4],"?"+this.getQueryString()),this},c.prototype.getQueryString=function(){return b.construct(this.queryString)},c.prototype.printHeaders=function(){var a=[],b=HTTPArchiveURLRegExp.exec(this.url),c=b[4]?b[3]+b[4]:b[3];a.push(this.method+" "+c+" "+this.httpVersion);for(var d in this.props._headers)a.push(d+": "+this.props._headers[d]);return a.join("\r\n")+"\r\n\r\n"},c.prototype.toCurl=function(a){for(var b=["curl"],c={beautify:void 0===a.beautify?!1:a.beautify,indent_size:void 0===a.indent_size?2:a.indent_size,indent_char:void 0===a.indent_char?" ":a.indent_char},d="";c.indent_size>0;)d+=c.indent_char,c.indent_size-=1;b.push("-X "+this.method);var e=[];return this.cookies.forEach(function(a){e.push(a.name+"="+a.value)}),e.length>0&&b.push('--cookie "'+e.join(";")+'"'),this.headers.forEach(function(a){b.push('-H "'+a.name+":"+a.value+'"')}),b.push('"'+this.url+'"'),b.join(c.beautify===!0?" \\\n"+d:" ")},c.prototype.toString=function(){return this.printHeaders()}}(window||this),function(a){"use strict";var b=a.HTTPArchiveResponse=function(a,b){this._strict=void 0===b?!0:b,Object.defineProperties(this,new HTTPArchiveHeadersProps(this)),Object.defineProperties(this,{_strict:{enumerable:!1,writable:!0,value:!0},status:{enumerable:!0,writable:!0,value:0},statusText:{enumerable:!0,writable:!0,value:""},httpVersion:{enumerable:!0,writable:!0,value:"HTTP/1.1"},redirectURL:{enumerable:!0,writable:!0,value:""},bodySize:{enumerable:!0,writable:!0,value:0},content:{enumerable:!0,writable:!0,value:{size:0,mimeType:"",text:""}},comment:{enumerable:!0,writable:!0,value:void 0}}),this.setOptions(a)};b.prototype.printHeaders=function(){var a=[];a.push(this.httpVersion+" "+this.status+" "+this.statusText);for(var b in this.props._headers)a.push(b+": "+this.props._headers[b]);return a.join("\r\n")+"\r\n\r\n"},b.prototype.toString=function(){return this.printHeaders()}}(window||this),function(a){"use strict";a.HTTPArchiveURLRegExp=/\b(https?|ftp):\/\/([\-A-Z0-9.]+)(\/[\-A-Z0-9+&@#\/%=~_|!:,.;]*)?(\?[A-Z0-9+&@#\/%=~_|!:,.;]*)?/i,a.HTTPArchiveHeadersProps=function(a){return{props:{enumerable:!1,configurable:!1,value:{_headers:{},_cookies:{}}},headersSize:{enumerable:!0,get:function(){var a=this.printHeaders();return a.length>0?a.length:-1}.bind(a),set:function(){return this}.bind(a)},headers:{enumerable:!0,get:function(){var a=[];for(var b in this.props._headers)a.push({name:b,value:this.props._headers[b]});return a}.bind(a),set:function(a){if(!Array.isArray(a))throw new Error("invalid headers array. expected Array, instead got "+typeof a);return 0===a.length?this.props._headers={}:a.forEach(this.setHeader,this),this}.bind(a)},cookies:{enumerable:!0,get:function(){var a=[];for(var b in this.props._cookies){var c=this.props._cookies[b];c.name=b,a.push(c)}return a}.bind(a),set:function(a){if(!Array.isArray(a))throw new Error("invalid cookies array. expected Array, instead got "+typeof a);a.forEach(this.setCookie,this)}.bind(a)}}};HTTPArchiveLog.prototype.setOptions=HTTPArchiveRequest.prototype.setOptions=HTTPArchiveResponse.prototype.setOptions=HTTPArchivePage.prototype.setOptions=HTTPArchiveEntry.prototype.setOptions=function(a){if(0===arguments.length||void 0===a)throw new Error("constructor called with no arguments, expected options.");if("object"!=typeof a||Array.isArray(a))throw new Error("invalid options object.");for(var b in a)if(a.hasOwnProperty(b)){if(this._strict&&!this.hasOwnProperty(b))throw new Error("invalid options object. ["+b+"].");this[b]=a[b]}},HTTPArchiveLog.prototype.toJSON=HTTPArchiveRequest.prototype.toJSON=HTTPArchiveResponse.prototype.toJSON=HTTPArchivePage.prototype.toJSON=HTTPArchiveEntry.prototype.toJSON=function(){var a={};for(var b in this){var c=this[b];if(this.hasOwnProperty(b)&&void 0!==c){if(null===c){a[b]=c;continue}if(c instanceof Date)a[b]=c.toISOString();else if(c.toJSON)a[b]=c.toJSON();else if(Array.isArray(c)){for(var d in c)c[d].toJSON&&(c[d]=c[d].toJSON());a[b]=c}else a[b]=c}}return a},HTTPArchiveRequest.prototype.getHeader=HTTPArchiveResponse.prototype.getHeader=function(a){return this.props._headers[a]},HTTPArchiveRequest.prototype.hasHeader=HTTPArchiveResponse.prototype.hasHeader=function(a){return this.props._headers.hasOwnProperty(a)},HTTPArchiveRequest.prototype.removeHeader=HTTPArchiveResponse.prototype.removeHeader=function(a){return delete this.props._headers[a],this},HTTPArchiveRequest.prototype.setHeader=HTTPArchiveResponse.prototype.setHeader=function(a,b){if("object"==typeof a){if(!a.hasOwnProperty("name")||!a.hasOwnProperty("value"))throw new Error("invalid header object");this.setHeader(a.name,a.value)}else this.props._headers[a]=b;return this},HTTPArchiveRequest.prototype.getCookieObject=HTTPArchiveResponse.prototype.getCookieObject=function(a){return this.props._cookies[a]},HTTPArchiveRequest.prototype.getCookie=HTTPArchiveResponse.prototype.getCookie=function(a){return this.props._cookies[a].value},HTTPArchiveRequest.prototype.hasCookie=HTTPArchiveResponse.prototype.hasCookie=function(a){return this.props._cookies.hasOwnProperty(a)},HTTPArchiveRequest.prototype.setCookie=HTTPArchiveResponse.prototype.setCookie=function(a,b,c,d,e,f,g,h){if("object"==typeof arguments[0])return this.setCookie.apply(this,[arguments[0].name,arguments[0].value,arguments[0].path,arguments[0].domain,arguments[0].expires,arguments[0].httpOnly,arguments[0].secure,arguments[0].comment]);if(void 0===a||void 0===b)throw new Error("cookie must have a name and value");return this.props._cookies[a]={name:a,value:b,path:c||"/",domain:d||"",expires:void 0!==e?e:(new Date).toISOString(),httpOnly:f||!1,secure:g||!1,comment:h||""},this}}(window||this);